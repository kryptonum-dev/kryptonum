---
import Nav, { Nav_Query, type NavProps } from './Nav.astro'
import Metadata, { Metadata_Query, type MetadataProps } from './Metadata.astro'
import ContentPT, { ContentPT_Query, type Props as ContentPTProps } from './content-pt/index.astro'

export type ContentProps = NavProps &
  MetadataProps & {
    content: ContentPTProps['value']
  }

export const Content_Query = `
  "content": {
    ${Nav_Query}
    ${Metadata_Query}
    ${ContentPT_Query}
  },
`

const { headings, content, author } = Astro.props as ContentProps
---

<article class="article">
  <Nav headings={headings} />
  <section class="article-content">
    <Metadata {...{ content, author }} />
    <ContentPT value={content} />
  </section>
</article>

<style lang="scss">
  .article {
    display: grid;
    grid-template-columns: 1fr 2.66fr;
    align-items: flex-start;
    gap: clamp(3rem, calc(4vw / 0.48), 5rem) clamp(3rem, calc(3vw / 0.48), 7rem);
    :global(.article-nav) {
      position: sticky;
      top: 89px;
      border-right: 1px solid var(--primary-600, #042b2b);
      padding-right: 1rem;
    }
    .article-content {
      font-size: var(--typography-body-2xl, 1.25rem);
      > {
        :global(p),
        :global(ul),
        :global(ol) {
          margin-bottom: clamp(1.25rem, calc(1.5vw / 0.48), 1.5rem);
        }
        :global(:nth-child(2)) {
          margin-top: 0;
        }
        :global(:last-child) {
          margin-bottom: 0;
        }
        :global(h2) {
          font-size: var(--typography-heading-2xl, 2.25rem);
          margin: clamp(4rem, calc(6vw / 0.48), 6rem) 0 clamp(1.5rem, calc(2vw / 0.48), 2rem);
        }
        :global(h3) {
          font-size: var(--typography-heading-xl, 1.875rem);
        }
        :global(h4) {
          font-size: var(--typography-heading-l, 1.5rem);
        }
        :global(h3),
        :global(h4) {
          margin: clamp(1.5rem, calc(2.25vw / 0.48), 2.25rem) 0 clamp(1.25rem, calc(1.5vw / 0.48), 1.5rem);
        }
        :global(ul) {
          margin: clamp(1.25rem, calc(2vw / 0.48), 2rem) 0;
        }
      }
    }
    @media (max-width: 74rem) {
      max-width: 48rem;
      margin: 0 auto;
      grid-template-columns: 1fr;
      :global(.article-nav) {
        position: static;
        border-right: none;
        padding-right: 0;
      }
    }
  }
</style>
